<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>گردونه شانس دبستان شهید قائمی</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>🎡</text></svg>">
    <link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/Vazirmatn-font-face.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Vazirmatn, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 30px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        h1 {
            text-align: center;
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .subtitle {
            text-align: center;
            color: #666;
            font-size: 1.2em;
            margin-bottom: 40px;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            margin-bottom: 40px;
        }

        .wheel-section {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .wheel-container {
            position: relative;
            width: 400px;
            height: 400px;
            margin-bottom: 30px;
        }

        .wheel {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 15px solid #fff;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            transition: transform 4s cubic-bezier(0.25, 0.1, 0.25, 1);
            background: conic-gradient(
                from 0deg,
                #ff6b6b 0deg 21.18deg,
                #4ecdc4 21.18deg 42.35deg,
                #45b7d1 42.35deg 63.53deg,
                #96ceb4 63.53deg 84.71deg,
                #ffeaa7 84.71deg 105.88deg,
                #fd79a8 105.88deg 127.06deg,
                #a29bfe 127.06deg 148.24deg,
                #fab1a0 148.24deg 169.41deg,
                #55efc4 169.41deg 190.59deg,
                #81ecec 190.59deg 211.76deg,
                #74b9ff 211.76deg 232.94deg,
                #ff7675 232.94deg 254.12deg,
                #fdcb6e 254.12deg 275.29deg,
                #6c5ce7 275.29deg 296.47deg,
                #fd79a8 296.47deg 317.65deg,
                #00b894 317.65deg 338.82deg,
                #e17055 338.82deg 360deg
            );
        }

        .wheel.spinning {
            transform: rotate(1800deg);
        }

        .pointer {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 20px solid transparent;
            border-right: 20px solid transparent;
            border-top: 40px solid #ff6b6b;
            filter: drop-shadow(0 4px 6px rgba(0, 0, 0, 0.3));
            z-index: 10;
        }

        .spin-btn {
            padding: 20px 60px;
            font-size: 1.5em;
            font-family: Vazirmatn, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
            transition: all 0.3s;
            font-weight: bold;
        }

        .spin-btn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.6);
        }

        .spin-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .winner-announcement {
            margin-top: 30px;
            padding: 30px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border-radius: 20px;
            text-align: center;
            color: white;
            font-size: 1.8em;
            font-weight: bold;
            opacity: 0;
            transform: scale(0.8);
            transition: all 0.5s;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .winner-announcement.show {
            opacity: 1;
            transform: scale(1);
        }

        .students-section {
            background: #f8f9fa;
            border-radius: 20px;
            padding: 30px;
        }

        .students-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .students-header h2 {
            color: #667eea;
            font-size: 1.8em;
        }

        .reset-btn {
            padding: 10px 20px;
            background: #e74c3c;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-family: Vazirmatn, sans-serif;
            transition: all 0.3s;
        }

        .reset-btn:hover {
            background: #c0392b;
            transform: translateY(-2px);
        }

        .add-student {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .add-student input {
            flex: 1;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-family: Vazirmatn, sans-serif;
            font-size: 1em;
        }

        .add-btn {
            padding: 12px 30px;
            background: #27ae60;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-family: Vazirmatn, sans-serif;
            transition: all 0.3s;
        }

        .add-btn:hover {
            background: #229954;
        }

        .students-list {
            display: grid;
            gap: 10px;
            max-height: 400px;
            overflow-y: auto;
        }

        .student-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            transition: all 0.3s;
        }

        .student-item:hover {
            transform: translateX(-5px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
        }

        .delete-btn {
            padding: 8px 15px;
            background: #e74c3c;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-family: Vazirmatn, sans-serif;
            transition: all 0.3s;
        }

        .delete-btn:hover {
            background: #c0392b;
        }

        .winners-section {
            background: #f8f9fa;
            border-radius: 20px;
            padding: 30px;
        }

        .winners-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .winners-header h2 {
            color: #667eea;
            font-size: 1.8em;
        }

        .clear-all-btn {
            padding: 10px 20px;
            background: #e67e22;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-family: Vazirmatn, sans-serif;
            transition: all 0.3s;
        }

        .clear-all-btn:hover {
            background: #d35400;
        }

        .winners-list {
            display: grid;
            gap: 10px;
            max-height: 300px;
            overflow-y: auto;
        }

        .winner-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .winner-info {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .winner-name {
            font-weight: bold;
            color: #667eea;
            font-size: 1.1em;
        }

        .winner-date {
            color: #666;
            font-size: 0.9em;
        }

        @media (max-width: 968px) {
            .main-content {
                grid-template-columns: 1fr;
            }

            .wheel-container {
                width: 300px;
                height: 300px;
            }

            h1 {
                font-size: 2em;
            }
        }

        .empty-message {
            text-align: center;
            color: #999;
            padding: 30px;
            font-size: 1.1em;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🎡 گردونه شانس دبستان شهید قائمی</h1>
        <p class="subtitle">پایه پنجم و ششم</p>

        <div class="main-content">
            <div class="wheel-section">
                <div class="wheel-container">
                    <div class="pointer"></div>
                    <div class="wheel" id="wheel"></div>
                </div>
                <button class="spin-btn" id="spinBtn">🎯 انتخاب شانسی</button>
                <div class="winner-announcement" id="winnerAnnouncement"></div>
            </div>

            <div class="students-section">
                <div class="students-header">
                    <h2>📝 لیست دانش‌آموزان</h2>
                    <button class="reset-btn" onclick="resetStudents()">بازنشانی</button>
                </div>
                <div class="add-student">
                    <input type="text" id="newStudentInput" placeholder="نام دانش‌آموز جدید...">
                    <button class="add-btn" onclick="addStudent()">افزودن</button>
                </div>
                <div class="students-list" id="studentsList"></div>
            </div>
        </div>

        <div class="winners-section">
            <div class="winners-header">
                <h2>🏆 برندگان قبلی</h2>
                <button class="clear-all-btn" onclick="clearAllWinners()">پاک کردن همه</button>
            </div>
            <div class="winners-list" id="winnersList"></div>
        </div>
    </div>

    <script>
        const defaultStudents = [
            'فواد آبسالان',
            'مبین بخشی',
            'پوریا پنبه کار',
            'امیرحسین ضایی',
            'آرش هاشم پور',
            'کیمیا اخوت',
            'باران واحدیان',
            'نرگس وکیلیان',
            'زهرا کوهستانیان',
            'فاطیما قاسم نژاد',
            'کوثر بخشی',
            'امیرحسین آبسالان',
            'طاها قوشچی',
            'طهورا قوشچی',
            'علیرضا محمدپور',
            'محمدجواد زیار',
            'مهدی شعبانی'
        ];

        let students = [...defaultStudents];
        let winners = [];
        let isSpinning = false;

        // Audio Context for sound effects
        const AudioContext = window.AudioContext || window.webkitAudioContext;
        const audioCtx = new AudioContext();

        // Sound effects using Web Audio API
        function playClickSound() {
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            
            oscillator.frequency.value = 800;
            oscillator.type = 'sine';
            
            gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.1);
            
            oscillator.start(audioCtx.currentTime);
            oscillator.stop(audioCtx.currentTime + 0.1);
        }

        function playSpinSound() {
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            
            oscillator.type = 'sawtooth';
            oscillator.frequency.setValueAtTime(200, audioCtx.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(100, audioCtx.currentTime + 3);
            
            gainNode.gain.setValueAtTime(0.2, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 3);
            
            oscillator.start(audioCtx.currentTime);
            oscillator.stop(audioCtx.currentTime + 3);
        }

        function playTickSound(pitch) {
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            
            oscillator.frequency.value = pitch;
            oscillator.type = 'square';
            
            gainNode.gain.setValueAtTime(0.1, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.05);
            
            oscillator.start(audioCtx.currentTime);
            oscillator.stop(audioCtx.currentTime + 0.05);
        }

        function playWinnerSound() {
            // Victory fanfare
            const notes = [523.25, 587.33, 659.25, 783.99, 880.00];
            notes.forEach((freq, index) => {
                setTimeout(() => {
                    const oscillator = audioCtx.createOscillator();
                    const gainNode = audioCtx.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioCtx.destination);
                    
                    oscillator.frequency.value = freq;
                    oscillator.type = 'sine';
                    
                    gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
                    
                    oscillator.start(audioCtx.currentTime);
                    oscillator.stop(audioCtx.currentTime + 0.5);
                }, index * 100);
            });
        }

        function playDeleteSound() {
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            
            oscillator.frequency.setValueAtTime(600, audioCtx.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(200, audioCtx.currentTime + 0.2);
            oscillator.type = 'sawtooth';
            
            gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.2);
            
            oscillator.start(audioCtx.currentTime);
            oscillator.stop(audioCtx.currentTime + 0.2);
        }

        function playAddSound() {
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            
            oscillator.frequency.setValueAtTime(400, audioCtx.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(800, audioCtx.currentTime + 0.2);
            oscillator.type = 'sine';
            
            gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.2);
            
            oscillator.start(audioCtx.currentTime);
            oscillator.stop(audioCtx.currentTime + 0.2);
        }

        // Background music
        let bgMusicOscillator = null;
        let bgMusicGain = null;
        let isMusicPlaying = false;

        function startBackgroundMusic() {
            if (isMusicPlaying) return;
            
            bgMusicGain = audioCtx.createGain();
            bgMusicGain.connect(audioCtx.destination);
            bgMusicGain.gain.value = 0.05;
            
            const notes = [261.63, 293.66, 329.63, 349.23, 392.00, 440.00, 493.88, 523.25];
            let noteIndex = 0;
            
            function playNextNote() {
                if (!isMusicPlaying) return;
                
                const oscillator = audioCtx.createOscillator();
                oscillator.connect(bgMusicGain);
                oscillator.type = 'sine';
                oscillator.frequency.value = notes[noteIndex % notes.length];
                
                oscillator.start(audioCtx.currentTime);
                oscillator.stop(audioCtx.currentTime + 0.3);
                
                noteIndex++;
                setTimeout(playNextNote, 400);
            }
            
            isMusicPlaying = true;
            playNextNote();
        }

        function stopBackgroundMusic() {
            isMusicPlaying = false;
        }

        // Load data
        function loadData() {
            const savedStudents = getCookie('students');
            const savedWinners = getCookie('winners');
            
            if (savedStudents) {
                students = JSON.parse(savedStudents);
            }
            
            if (savedWinners) {
                winners = JSON.parse(savedWinners);
            }
            
            renderStudents();
            renderWinners();
        }

        // Cookie functions
        function setCookie(name, value, days = 365) {
            const date = new Date();
            date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
            document.cookie = name + "=" + value + ";expires=" + date.toUTCString() + ";path=/";
        }

        function getCookie(name) {
            const nameEQ = name + "=";
            const ca = document.cookie.split(';');
            for(let i = 0; i < ca.length; i++) {
                let c = ca[i];
                while (c.charAt(0) === ' ') c = c.substring(1, c.length);
                if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);
            }
            return null;
        }

        // Render functions
        function renderStudents() {
            const list = document.getElementById('studentsList');
            if (students.length === 0) {
                list.innerHTML = '<div class="empty-message">هیچ دانش‌آموزی در لیست نیست</div>';
                return;
            }
            
            list.innerHTML = students.map((student, index) => `
                <div class="student-item">
                    <span>${student}</span>
                    <button class="delete-btn" onclick="deleteStudent(${index})">حذف</button>
                </div>
            `).join('');
        }

        function renderWinners() {
            const list = document.getElementById('winnersList');
            if (winners.length === 0) {
                list.innerHTML = '<div class="empty-message">هنوز برنده‌ای انتخاب نشده است</div>';
                return;
            }
            
            list.innerHTML = winners.map((winner, index) => `
                <div class="winner-item">
                    <div class="winner-info">
                        <span class="winner-name">${winner.name}</span>
                        <span class="winner-date">${winner.date}</span>
                    </div>
                    <button class="delete-btn" onclick="deleteWinner(${index})">حذف</button>
                </div>
            `).join('');
        }

        // Student management
        function addStudent() {
            const input = document.getElementById('newStudentInput');
            const name = input.value.trim();
            
            if (name) {
                playAddSound();
                students.push(name);
                setCookie('students', JSON.stringify(students));
                renderStudents();
                input.value = '';
            }
        }

        function deleteStudent(index) {
            playDeleteSound();
            students.splice(index, 1);
            setCookie('students', JSON.stringify(students));
            renderStudents();
        }

        function resetStudents() {
            playClickSound();
            students = [...defaultStudents];
            setCookie('students', JSON.stringify(students));
            renderStudents();
        }

        // Winner management
        function deleteWinner(index) {
            playDeleteSound();
            winners.splice(index, 1);
            setCookie('winners', JSON.stringify(winners));
            renderWinners();
        }

        function clearAllWinners() {
            if (confirm('آیا مطمئن هستید که می‌خواهید همه برندگان را پاک کنید؟')) {
                playDeleteSound();
                winners = [];
                setCookie('winners', JSON.stringify(winners));
                renderWinners();
            }
        }

        // Persian date
        function getPersianDate() {
            const date = new Date();
            return new Intl.DateTimeFormat('fa-IR', {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            }).format(date);
        }

        // Spin wheel
        document.getElementById('spinBtn').addEventListener('click', function() {
            if (isSpinning || students.length === 0) return;
            
            if (students.length === 0) {
                alert('لطفاً ابتدا دانش‌آموزانی را به لیست اضافه کنید');
                return;
            }
            
            isSpinning = true;
            this.disabled = true;
            
            const wheel = document.getElementById('wheel');
            const announcement = document.getElementById('winnerAnnouncement');
            
            announcement.classList.remove('show');
            
            // Random winner
            const winnerIndex = Math.floor(Math.random() * students.length);
            const winner = students[winnerIndex];
            
            // Spin animation
            wheel.classList.add('spinning');
            
            setTimeout(() => {
                wheel.classList.remove('spinning');
                
                // Show winner
                announcement.textContent = `🎉 برنده: ${winner}`;
                announcement.classList.add('show');
                
                // Save winner
                winners.unshift({
                    name: winner,
                    date: getPersianDate()
                });
                setCookie('winners', JSON.stringify(winners));
                renderWinners();
                
                isSpinning = false;
                this.disabled = false;
            }, 4000);
        });

        // Add student on Enter key
        document.getElementById('newStudentInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                addStudent();
            }
        });

        // Initialize
        loadData();
    </script>
</body>
</html>